---
import BaseLayout from '../layouts/BaseLayout.astro';
import Section from '../components/ui/Section.astro';
import Button from '../components/ui/Button.astro';
import DoctorHighlight from '../components/dental/DoctorHighlight.astro';
import { getCollection, getEntryBySlug } from 'astro:content';
import Breadcrumbs from '../components/ui/Breadcrumbs.astro';

const team = await getCollection('team');
const leadDoctor = team.sort((a, b) => (a.data.order ?? 0) - (b.data.order ?? 0))[0];
const aboutEntry = await getEntryBySlug('pages', 'about');

if (!aboutEntry) {
  throw new Error('About page content not found');
}

const { Content } = await aboutEntry.render();
const { title, heroEyebrow, heroTitle, heroSubheadline, intro } = aboutEntry.data;
const pageTitle = heroTitle ?? title;
const description = heroSubheadline ?? intro ?? title;
---

<BaseLayout title={title} description={description}>
  <main>
    <section class="bg-surface-soft">
      <div class="mx-auto max-w-6xl px-4 py-16 md:py-20">
        <div class="space-y-4">
          <Breadcrumbs items={[{ label: 'Home', href: '/' }, { label: heroEyebrow || 'About' }]} />
          {heroEyebrow && (
            <p class="text-xs font-semibold uppercase tracking-wide text-ink-400">{heroEyebrow}</p>
          )}
          <h1 class="font-heading text-4xl tracking-tight text-ink-900 md:text-5xl">{pageTitle}</h1>
          {heroSubheadline && (
            <p class="max-w-3xl text-sm leading-relaxed text-ink-600 md:text-base">
              {heroSubheadline}
            </p>
          )}
          {intro && (
            <p class="max-w-3xl text-sm leading-relaxed text-ink-600 md:text-base">
              {intro}
            </p>
          )}
          {Content && (
            <div class="prose prose-slate max-w-none text-sm md:text-base">
              <Content />
            </div>
          )}
          <div class="flex flex-wrap gap-3">
            <Button href="/services" variant="primary">View our services</Button>
            <Button href="/team" variant="outline">Meet the team</Button>
          </div>
        </div>
      </div>
    </section>

    <section class="bg-surface-soft">
      <div class="mx-auto grid max-w-6xl items-start gap-8 px-4 py-16 md:grid-cols-2 md:py-20">
        <div class="space-y-4">
          <h2 class="font-heading text-3xl text-ink-900 md:text-4xl">Our story: calm, clear, and built for you</h2>
          <p class="max-w-3xl text-sm leading-relaxed text-ink-600 md:text-base">
            We listen first, then design a plan around your goals, schedule, and comfort level. Digital workflows, 3D imaging, and clear aligners help us deliver precise, efficient care—without surprises.
          </p>
          <div class="space-y-2 rounded-3xl bg-surface p-5 shadow-card-soft ring-1 ring-surface-border">
            <p class="text-sm font-semibold uppercase tracking-wide text-accent-500">How we care for Sampletown</p>
            <ul class="list-disc list-inside space-y-2 text-sm text-ink-700">
              <li>Comfort-first approach with gentle techniques and communication.</li>
              <li>Transparent treatment plans and timelines before we begin.</li>
              <li>Modern tech for better diagnostics and predictable results.</li>
              <li>Flexible financing options to fit your budget.</li>
            </ul>
          </div>
        </div>
        <div class="space-y-4 rounded-3xl bg-surface p-6 shadow-card-soft ring-1 ring-surface-border">
          <h3 class="text-xl font-heading text-ink-900">What to expect on your first visit</h3>
          <div class="space-y-3 text-sm text-ink-700">
            <div class="flex items-start gap-3">
              <span class="mt-1 inline-flex h-8 w-8 items-center justify-center rounded-full bg-brand-50 text-brand-600 ring-1 ring-surface-border">1</span>
              <p>Warm welcome, quick check-in, and a clear overview of your visit.</p>
            </div>
            <div class="flex items-start gap-3">
              <span class="mt-1 inline-flex h-8 w-8 items-center justify-center rounded-full bg-brand-50 text-brand-600 ring-1 ring-surface-border">2</span>
              <p>Digital imaging and a thorough exam—see what we see on-screen.</p>
            </div>
            <div class="flex items-start gap-3">
              <span class="mt-1 inline-flex h-8 w-8 items-center justify-center rounded-full bg-brand-50 text-brand-600 ring-1 ring-surface-border">3</span>
              <p>Options, pricing, and timelines explained in plain language.</p>
            </div>
            <div class="flex items-start gap-3">
              <span class="mt-1 inline-flex h-8 w-8 items-center justify-center rounded-full bg-brand-50 text-brand-600 ring-1 ring-surface-border">4</span>
              <p>Comfort choices during care—noise-cancelling headphones, blankets, and gentle anesthesia when needed.</p>
            </div>
          </div>
          <div class="flex flex-wrap gap-3">
            <Button href="/new-patients" variant="primary">New patient info</Button>
            <Button href="/services" variant="outline">Explore services</Button>
          </div>
        </div>
      </div>
    </section>

    <section class="relative overflow-hidden bg-ink-900">
      <div class="absolute inset-0">
        <img
          src="/images/practice-interior-wide.png"
          alt="Bright, modern dental studio interior at BrightSide Dental Studio in Sampletown."
          class="h-full w-full object-cover"
          loading="lazy"
        />
        <div class="absolute inset-0 bg-gradient-to-r from-ink-900/85 via-ink-900/55 to-transparent"></div>
      </div>

      <div class="relative mx-auto flex max-w-6xl items-center px-4 py-12 md:py-16">
        <div class="max-w-md space-y-3 text-white">
          <p class="text-xs font-semibold uppercase tracking-wide text-white/70">
            Inside BrightSide
          </p>
          <h2 class="text-2xl font-semibold tracking-tight md:text-3xl">
            Take a look inside the practice
          </h2>
          <p class="text-sm leading-relaxed text-white/80">
            Light-filled rooms, modern equipment, and a calm setting designed to make visits feel more like a check-in than a chore.
          </p>
        </div>
      </div>
    </section>

    {leadDoctor && <DoctorHighlight doctor={leadDoctor} />}

    <section class="bg-surface-soft">
      <div class="mx-auto max-w-6xl px-4 py-16 md:py-20">
        <div class="grid gap-8 md:grid-cols-3">
          {[
            {
              label: 'Technology',
              title: 'Modern tools, clearer answers',
              copy: '3D imaging, digital impressions, and clear aligner planning help us diagnose accurately and show you options on screen.',
            },
            {
              label: 'Comfort',
              title: 'Gentle, calm visits',
              copy: 'Comfort menu, nitrous when appropriate, and a team trained to explain each step so you can relax.',
            },
            {
              label: 'Access',
              title: 'Flexible for real life',
              copy: 'Prompt scheduling, financing guidance, and clear next steps—whether you need family cleanings or dental implants in Sampletown.',
            },
          ].map((item) => (
            <div class="space-y-2 rounded-3xl bg-surface p-5 shadow-card-soft ring-1 ring-surface-border">
              <p class="text-xs font-semibold uppercase tracking-[0.18em] text-accent-500">{item.label}</p>
              <h3 class="text-lg font-heading text-ink-900">{item.title}</h3>
              <p class="text-sm leading-relaxed text-ink-700">{item.copy}</p>
            </div>
          ))}
        </div>
      </div>
    </section>

    <section class="bg-surface-soft">
      <div class="mx-auto max-w-6xl px-4 py-16 md:py-20">
        <div class="grid items-center gap-8 rounded-3xl bg-gradient-to-br from-halo-blue via-surface-soft to-halo-mint p-6 shadow-card-soft ring-1 ring-surface-border md:grid-cols-[1.05fr_0.95fr] md:p-8">
          <div class="space-y-3">
            <p class="text-xs font-semibold uppercase tracking-wide text-ink-400">New patients</p>
            <h2 class="text-xl font-semibold tracking-tight text-ink-900 md:text-2xl">Plan your first visit</h2>
            <p class="mt-2 max-w-2xl text-sm leading-relaxed text-ink-600">We’ll help with directions, forms, insurance checks, and comfort options so you can focus on your smile.</p>
            <div class="mt-4 flex flex-wrap gap-3">
              <Button href="/new-patients" variant="primary">New patient info</Button>
              <Button href="/contact" variant="outline">Request appointment</Button>
            </div>
          </div>
          <div class="rounded-3xl bg-surface p-4 shadow-card-soft ring-1 ring-surface-border">
            <div class="aspect-video w-full overflow-hidden rounded-2xl bg-surface-soft ring-1 ring-surface-border/80">
              <img src="/images/office/interior.svg" alt="Office interior at BrightSide Dental Studio" class="h-full w-full object-cover" />
              <span class="sr-only">Illustration of forms and a checklist for new patients</span>
            </div>
          </div>
        </div>
      </div>
    </section>
  </main>
</BaseLayout>
