---
import BaseLayout from '../layouts/BaseLayout.astro';
import Section from '../components/ui/Section.astro';
import Button from '../components/ui/Button.astro';
import Breadcrumbs from '../components/ui/Breadcrumbs.astro';
import { getEntryBySlug } from 'astro:content';

const page = await getEntryBySlug('pages', 'financing');

if (!page) {
  throw new Error('Missing financing page content in src/content/pages/financing.md.');
}

const { Content } = await page.render();
const { heroEyebrow, heroTitle, heroSubheadline, intro, seoTitle, seoDescription, heroImage } = page.data;
const pageTitle = seoTitle ?? heroTitle ?? page.data.title;
const pageDescription = seoDescription ?? heroSubheadline ?? intro ?? '';
---

<BaseLayout title={pageTitle} description={pageDescription}>
  <main>
    <section class="bg-surface-soft">
      <div class="mx-auto max-w-6xl px-4 py-16 md:py-20">
        <div class="grid gap-8 md:grid-cols-[1.1fr_0.9fr] md:items-center">
          <div class="space-y-4">
            <Breadcrumbs items={[{ label: 'Home', href: '/' }, { label: heroEyebrow || page.data.title }]} />
            {heroEyebrow && (
              <p class="text-xs font-semibold uppercase tracking-wide text-ink-400">{heroEyebrow}</p>
            )}
            <h1 class="font-heading text-4xl tracking-tight text-ink-900 md:text-5xl">{heroTitle ?? page.data.title}</h1>
            {heroSubheadline && (
              <p class="max-w-3xl text-sm leading-relaxed text-ink-600 md:text-base">
                {heroSubheadline}
              </p>
            )}
            {intro && (
              <p class="max-w-3xl text-sm leading-relaxed text-ink-600 md:text-base">
                {intro}
              </p>
            )}
            <div class="flex flex-wrap gap-3">
              <Button href="/contact" variant="primary">Call our office</Button>
              <Button href="/new-patients" variant="outline">Request appointment</Button>
            </div>
          </div>
          {heroImage && (
            <div class="overflow-hidden rounded-3xl bg-surface shadow-card-soft ring-1 ring-surface-border">
              <img src={heroImage} alt={heroTitle ?? page.data.title} class="h-full w-full object-cover" loading="lazy" decoding="async" />
            </div>
          )}
        </div>
      </div>
    </section>

    <Section>
      <article class="prose prose-slate max-w-none prose-a:text-brand-600 text-sm md:text-base">
        <Content />
      </article>
    </Section>

    <Section>
      <div class="grid gap-6 md:grid-cols-3">
        <div class="space-y-2 rounded-2xl bg-white p-5 shadow-card ring-1 ring-gray-100">
          <p class="text-sm uppercase tracking-wide text-primary font-semibold">Insurance</p>
          <h2 class="text-lg font-heading text-neutral">We help maximize your benefits</h2>
          <p class="text-sm text-gray-700">We work with most major PPO plans. Share your insurance info when scheduling and we’ll verify coverage before your visit.</p>
        </div>
        <div class="space-y-2 rounded-2xl bg-white p-5 shadow-card ring-1 ring-gray-100">
          <p class="text-sm uppercase tracking-wide text-primary font-semibold">Transparent estimates</p>
          <h2 class="text-lg font-heading text-neutral">Know costs before treatment</h2>
          <p class="text-sm text-gray-700">We provide clear estimates, explain options, and help you prioritize care based on your goals and budget.</p>
        </div>
        <div class="space-y-2 rounded-2xl bg-white p-5 shadow-card ring-1 ring-gray-100">
          <p class="text-sm uppercase tracking-wide text-primary font-semibold">Guidance</p>
          <h2 class="text-lg font-heading text-neutral">Friendly help with billing</h2>
          <p class="text-sm text-gray-700">Ask us about benefits, EOBs, and payment timing—we’ll help simplify the process.</p>
        </div>
      </div>
    </Section>

    <Section>
      <div class="grid gap-8 md:grid-cols-2">
        <div class="space-y-3 rounded-3xl bg-gradient-to-br from-primary/8 via-white to-secondary/10 p-6 shadow-card ring-1 ring-primary/10">
          <p class="text-sm uppercase tracking-wide text-primary font-semibold">Payment options</p>
          <h2 class="text-2xl font-heading text-neutral">Flexible ways to pay</h2>
          <ul class="list-disc list-inside text-sm text-gray-700 space-y-2">
            <li>All major credit and debit cards</li>
            <li>HSA/FSA cards</li>
            <li>Financing available for larger treatments</li>
            <li>Phased care plans to fit your budget</li>
          </ul>
          <div class="flex flex-wrap gap-3 pt-2">
            <Button href="/new-patients" variant="primary">Request estimate</Button>
            <Button href="/contact" variant="outline">Ask about coverage</Button>
          </div>
        </div>
        <div class="space-y-3 rounded-2xl bg-white p-6 shadow-card ring-1 ring-gray-100">
          <p class="text-sm uppercase tracking-wide text-primary font-semibold">Membership plan</p>
          <h2 class="text-2xl font-heading text-neutral">No insurance? We’ve got you</h2>
          <p class="text-sm text-gray-700">Join our in-house membership for predictable preventive care and member savings on additional treatment.</p>
          <ul class="list-disc list-inside text-sm text-gray-700 space-y-2">
            <li>Includes cleanings, exams, and X-rays</li>
            <li>Member discounts on restorative and cosmetic care</li>
            <li>No deductibles, waiting periods, or yearly maximums</li>
          </ul>
          <Button href="/contact" variant="primary" class="mt-2">Ask about membership</Button>
        </div>
      </div>
    </Section>
  </main>
</BaseLayout>
